# Smart Cache

ฺฉุด ูุงุจุณุชู ุจู ูุฏู ุจุฑุง ูุงุฑุงูู ุจุง invalidation ุฎูุฏฺฉุงุฑุ ูพุดุชุจุงู ุงุฒ ุชฺฏ ู ูุญุงูุธุช ุฏุฑ ุจุฑุงุจุฑ cache stampede.

---

## ูุตุจ

```bash
composer require karnoweb/smart-cache
```

---

## ุงุณุชูุงุฏูู ุณุฑุน

```php
use Karnoweb\SmartCache\Facades\SmartCache;
use App\Models\User;

// ุฐุฎุฑู ู ุฎูุงูุฏู
SmartCache::for(User::class)->key('features')->put($features);
$features = SmartCache::for(User::class)->key('features')->get();

// remember ุจุง ูุญุงูุธุช ุฏุฑ ุจุฑุงุจุฑ stampede
$data = SmartCache::for(User::class)
    ->key('dashboard')
    ->remember(fn () => expensiveQuery());
```

ุจุง trait ุฑู ูุฏู:

```php
use Karnoweb\SmartCache\Traits\HasModelCache;

class User extends Model
{
    use HasModelCache;
}
```

---

## ูุณุชูุฏุงุช

ูุณุชูุฏุงุช ุจู ุตูุฑุช ุณุงุฎุชุงุฑุงูุชู ู ูุงุจู ฺฏุณุชุฑุด ุฏุฑ ูพูุดูู **docs** ูุฑุงุฑ ุฏุงุฑุฏ. ุจุฑุง ููุฑุณุช ฺฉุงูู ู ุฏุณุชุฑุณ ุจู ูููู ุจุฎุดโูุง ุจู ูุงู ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:

**[๐ ููุฑุณุช ูุณุชูุฏุงุช (docs/0-index.md)](docs/0-index.md)**

ุจุฎุดโูุง ูุนู:

| # | ููุถูุน |
|---|--------|
| 1 | [ููุง ฺฉู](docs/1-overview.md) โ ูฺฺฏโูุง ู ูุนูุงุฑ |
| 2 | [ูุตุจ ู ุฑุงูโุงูุฏุงุฒ](docs/2-installation.md) |
| 3 | [ูพฺฉุฑุจูุฏ](docs/3-configuration.md) |
| 4 | [ุงุณุชูุงุฏู ู API](docs/4-usage.md) |
| 5 | [ุฌุฒุฆุงุช ูู](docs/5-technical-details.md) โ flushุ raceุ TTLุ stampedeุ ูุญุฏูุฏุชโูุง |

ุจุฑุง ุงูุฒูุฏู ูุจุงุญุซ ุฌุฏุฏ ุฏุฑ ุขูุฏูุ ูุงูโูุง ุดูุงุฑูโุฏุงุฑ ุฌุฏุฏ (ูุซูุงู `6-testing.md`) ุฑุง ุฏุฑ `docs` ุงุถุงูู ฺฉูุฏ ู ููฺฉ ุขูโูุง ุฑุง ุฏุฑ [docs/0-index.md](docs/0-index.md) ุซุจุช ฺฉูุฏ.

---

## ููุงุณู ุจุง ุณุงุฑ ุฑูุดโูุง

| ูฺฺฏ | Laravel Cache (ุฎุงู) | Laravel Tagged Cache | Smart Cache |
|--------|----------------------|----------------------|-------------|
| **ูุฏูโูุญูุฑ** | ุฎุฑ โ ฺฉูุฏูุง ุฏุณุช ู ูพุฑุงฺฉูุฏู | ุฎุฑ โ ุชฺฏ ุฏุณุช | ุจูู โ ฺฉูุฏูุง ุฒุฑ prefix ูุฏู |
| **Flush ุจูโุงุฒุง ยซูุฏูยป** | ุฎุฑ โ ุจุงุฏ ฺฉูุฏูุง ุฑุง ุจุฏุงู | ุจูู โ ุจุง flush ุชฺฏ | ุจูู โ `SmartCache::for(User::class)->flush()` |
| **Auto-invalidation ุจุง ุฑูุฏุงุฏ ูุฏู** | ุฎุฑ | ุฎุฑ | ุจูู (ุจุง trait ู config) |
| **Stampede protection ุฏุฑ remember** | ุฎุฑ (ุฎูุฏุช lock ุจุฒู) | ุฎุฑ | ุจูู (ูุงุจู ูุทุน ุจุง config) |
| **ฺฉุงุฑ ุจุง File/Database (ุจุฏูู ุชฺฏ)** | ุจูู | ุฎุฑ โ ููุท Redis/Memcached | ุจูู โ ุจุง RegistryDriver ู lock ุฏุฑ ุตูุฑุช ูพุดุชุจุงู ุงุณุชูุฑ |
| **ููุฏุดู ฺฉูุฏ** | ุฎุฑ | ุฎุฑ | ุจูู (ุทููุ ฺฉุงุฑุงฺฉุชุฑูุง ููููุน) |
| **Default TTL ูุชูุฑฺฉุฒ** | ุงุฒ config ฺฉุด | ุงุฒ config ฺฉุด | ุงุฒ config ูพฺฉุฌ (`default_ttl`) |

ุฏุฑ ููุงุณู ุจุง ูพฺฉุฌโูุง ูุซู **laravel-model-cache** (ฺฉุด ุฎูุฏ Eloquent): Smart Cache ฺฉุด ยซุฏูุฎูุงูยป ุจุฑุง ูุฏู ุงุณุช (ูุฑ ฺฉูุฏ/ููุฏุงุฑ)ุ ูู ููุท ฺฉุด ฺฉุฑุฏู ุฎูุฏ ฺฉูุฆุฑ/ูุฏูุ ู invalidation ูุนูุงู ุฏุฑ ุณุทุญ ยซฺฉู ูุฏูยป ุงุณุชุ ูู per-record (ฺฏุฑุงูููุงุฑ ุฏุฑ ูุณุฎูโูุง ุจุนุฏ ูุฏู ุงุณุช).

---

## ุชุณุช

```bash
composer install
./vendor/bin/phpunit
```

ุชุณุชโูุง ูุงุญุฏ ู ฺฉูพุงุฑฺฺฏ ุจุฑุง APIุ ููุฏุดู ฺฉูุฏุ RegistryDriver (array)ุ ู ฺฉูพุงุฑฺฺฏ ุจุง Facade ู ุงุณุชูุฑ array/file ูุฌูุฏ ุฏุงุฑุฏ. ุจุฑุง ุฌุฒุฆุงุช ูู (flushุ raceุ stampede) ุจู [docs/5-technical-details.md](docs/5-technical-details.md) ูุฑุงุฌุนู ฺฉูุฏ.

---

## ูุฏูโูุง ุจุนุฏ (ูพุดููุงุฏ)

- **ูุฑฺู ุงููู**: ุจุฑุง ุฑูพููุง ุชุงุฒู ูโุชูุงู ุจุง `v0.1.0` ุชฺฏ ุฒุฏ ู ุจู [Packagist](https://packagist.org) ูุฑุณุชุงุฏ ุชุง ูุตุจ ุจุง `composer require karnoweb/smart-cache` ุจุฏูู ุชุนุฑู repository ููฺฉู ุดูุฏ.
- **Granular invalidation**: ุฏุฑ ูุณุฎูโูุง ุจุนุฏ ูโุชูุงู invalidation ุจูโุงุฒุง ุฑฺฉูุฑุฏ (per-record) ุงุถุงูู ฺฉุฑุฏ ุชุง ุจูโุฌุง flush ุชูุงู ฺฉุด ูุฏูุ ููุท ฺฉูุฏูุง ูุงุจุณุชู ุจู ููุงู ุฑฺฉูุฑุฏ ูพุงฺฉ ุดููุฏ ู ูุดฺฉู flush ุชูุงุฌู ฺฉูุชุฑ ุดูุฏ.

---

## ูุงุฒููุฏโูุง

- PHP 8.2+
- Laravel 10.x / 11.x / 12.x

---

## ูุงุณูุณ

MIT
